// Prisma schema for Riftvault

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// The client will be generated in node_modules/.prisma/client
// when running prisma generate

generator client {
  provider = "prisma-client-js"
}

model Set {
  id    Int    @id @default(autoincrement())
  name  String @unique
  cards Card[]

  @@index([name])
}

model Faction {
  id    Int    @id @default(autoincrement())
  name  String @unique
  cards Card[]

  @@index([name])
}

model Rarity {
  id   Int    @id @default(autoincrement())
  name String @unique

  @@index([name])
}

model Keyword {
  id          Int           @id @default(autoincrement())
  name        String        @unique
  description String?
  cards       CardKeyword[]

  @@index([name])
}

model Card {
  id         Int      @id @default(autoincrement())
  cardId     String   @unique
  name       String
  type       String
  domain     String?
  costEnergy Int?
  costPower  Int?
  might      Int?
  rulesText  String?
  variants   String
  setId      Int
  set        Set      @relation(fields: [setId], references: [id])
  factionId  Int?
  faction    Faction? @relation(fields: [factionId], references: [id])
  keywords   CardKeyword[]
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@index([cardId])
  @@index([name])
  @@index([type])
  @@index([domain])
  @@index([setId])
  @@index([factionId])
  @@index([costEnergy])
  @@index([costPower])
}

model CardKeyword {
  id        Int     @id @default(autoincrement())
  cardId    Int
  keywordId Int
  card      Card    @relation(fields: [cardId], references: [id])
  keyword   Keyword @relation(fields: [keywordId], references: [id])

  @@unique([cardId, keywordId])
  @@index([keywordId])
}
